{{ if not .Params.exclude_from_summary }}
{{ $more_to_read := ne (len (trim .Summary " \n\r")) (len (trim .Content " \n\r"))}}
{{ $is_books := eq .Section "books" }}
{{ $is_ramble_blog_post := and (eq .Section "blog")  (in (index .Params "blog/tags") "ramble") }}
<article class="post-summary">
  {{ $is_less_important := in (index .Params "blog/tags") "ramble" }}
  {{ $summary_classes := cond $is_less_important "less-important" "" }}
  <div class="row summary-row {{ $summary_classes }} justify-content-center align-items-center">
  {{ $thumbnail := .Resources.GetMatch "thumbnail.*" }}
  {{ if $thumbnail }}
    <div class="col-7 col-sm-5 col-md-4">
      {{ $lazy_loading := "" }}
      {{ if .NextInSection }}
      {{ $lazy_loading = "lazy" }}
      {{ end }}
      {{ with $thumbnail.Resize "x300 webp" }}
      <img loading="{{ $lazy_loading }}" alt="" class="img-fluid rounded mx-auto d-block" width="{{ .Width }}" height="{{ .Height }}" src="{{ .RelPermalink }}">
      {{ end }}
      {{ if and .Params.star_rating }}
      <div class="text-center">
        {{ partial "try_star_rating" . }}
      </div>
      {{ end }}
    </div>
  {{ end }}
    <div class="col-md-8 align-self-center">
      <div class="summary-title h2">
        {{ if $more_to_read }}
        <a href='{{ .Permalink }}'>
          {{ end }}
          {{ .Render "title_text" }}
        {{ if $more_to_read }}
        </a>
        {{ end }}
      </div>
      <div class="row post-meta">
        <div class="col-mx-auto align-self-center">
            <div class="row">
            {{ $authors := (.GetTerms "authors" ) }}
              <div class="col">
                <div class="row">
                  {{ if $authors }}
                    {{ range $authors }}
                    <div class="col-12">
                      {{ $pretty_author := index $.Site.Data.tag_mapping .LinkTitle | default .LinkTitle }}
                      <a href="{{ .RelPermalink }}"> {{ $pretty_author }}</a>
                    </div>
                    {{- end -}}
                  {{- end -}}
                  <div class="col-12">
                    {{ if $is_books -}}
                      {{- if eq .Params.weight 1 -}}
                      Currently reading...
                      {{ else }}
                      Date read: {{ .Date.Format "Mon, Jan 2, 2006" }}
                      {{- end -}}
                    {{ else }}
                      {{- .Date.Format "Mon, Jan 2, 2006" }}
                      {{- $reading_time := .ReadingTime -}}
                      {{- if ne $reading_time 0 }}
                        ({{ $reading_time }}min read)
                      {{- end -}}
                    {{- end -}}
                  </div>
                </div>
              </div>
              {{- if not $is_ramble_blog_post -}}
              <div class="col align-self-end">
                {{ partial "try_tags" . }}
              </div>
              {{- end -}}
            </div>
        </div>
      </div>
      {{ if not $is_ramble_blog_post }}
      {{ .Summary }}
      <div class="col read-more">
        <a aria-labelledby="more" class="float-right" href='{{ .Permalink }}'>
          {{ if $more_to_read }}
          <span style="white-space: nowrap;"><h4 id="more">More â†’</h4></span>
          {{ end }} 
        </a>
      </div>
      {{ end }}
  </div>
</article>
<hr>
{{ end }}
