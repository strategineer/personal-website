{{ if not .Params.exclude_from_summary }}
{{ $is_books := eq .Section "books" }}
{{ $is_ramble_blog_post := and (eq .Section "blog")  (in (index .Params "blog/tags") "ramble") }}
<article class="post-summary">
  {{ $is_less_important := in (index .Params "blog/tags") "ramble" }}
  {{ $summary_classes := cond $is_less_important "less-important" "" }}
  <div class="row summary-row {{ $summary_classes }} justify-content-center">
  {{ $thumbnail := .Resources.GetMatch "thumbnail.*" }}
  {{ if $thumbnail }}
    <div class="col-7 col-sm-5 col-md-4">
      <div class="summary-title text-center">
        {{ partial "try_star_rating" . }}
      </div>
      {{ $lazy_loading := "" }}
      {{ if .NextInSection }}
      {{ $lazy_loading = "lazy" }}
      {{ end }}
      {{ with $thumbnail.Resize "x300 webp" }}
      <img loading="{{ $lazy_loading }}" alt="" class="img-fluid rounded mx-auto d-block" width="{{ .Width }}" height="{{ .Height }}" src="{{ .RelPermalink }}">
      {{ end }}
    </div>
  {{ end }}
    <div class="col-md-8 align-self-center">
      <h2 class="summary-title">
        <a href='{{ .Permalink }}'>
          {{ .Render "title_text" }}
          {{ if $is_books -}}
            {{ $authors := (.GetTerms "authors" ) }}
              {{ if $authors }}
              by
              {{ $i := 0 }}
              {{ range $authors }}
                {{- if (ge $i 1) -}},{{- end -}}
                {{ $pretty_author := index $.Site.Data.tag_mapping .LinkTitle | default .LinkTitle }}
                {{ $pretty_author }}
                {{ $i = add $i 1 }}
              {{- end -}}
            {{- end -}}
          {{- end -}}
        </a>
      </h2>
      <div class="row post-meta">
        <div class="col-auto align-self-center">
          {{ if $is_books -}}
            {{- if eq .Params.weight 1 -}}
            Currently reading...
            {{ else }}
            Date read: {{ .Date.Format "Mon, Jan 2, 2006" }}
            {{- end -}}
          {{ else }}
          {{- .Date.Format "Mon, Jan 2, 2006" }}
          {{- $reading_time := .ReadingTime -}}
          {{- if ne $reading_time 0 }}
          ({{ $reading_time }}min read)
          {{- end -}}
          {{- end -}}
        </div>
        {{ if not $is_ramble_blog_post }}
        <div class="col float-right">
          {{ partial "try_tags" . }}
        </div>
        {{ end }}
      </div>
      {{ if not $is_ramble_blog_post }}
      {{ .Summary }}
      {{ end }}
  </div>
  <div class="row read-more">
    <div class="col">
      <a aria-labelledby="more" class="float-right" href='{{ .Permalink }}'><nobr>
        {{ if ne (len .Summary) (len .Plain) }}
          <h2 id="more">More â†’</h3>
        {{ end }}
        </nobr>
      </a>
    </div>
  </div>
</article>
{{ end }}
